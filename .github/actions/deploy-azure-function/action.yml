name: Deploy Azure Function
description: 'Deploy a .NET project to Azure Function'

inputs:
  azure-function-app-name:
    required: true
    type: string
  azure-function-package-path:
    required: true
    type: string
  artifact-name:
    default: 'drop'
    type: string
  publish-profile:
    required: true
    type: string

runs:
  using: "composite"
  steps:
    - name: Download Build Artifact
      uses: actions/download-artifact@v4
      with:
        name: ${{ inputs.artifact-name }}
        path: ${{ inputs.azure-function-package-path }}

    - name: 'Login via Azure CLI'
      uses: azure/login@v2
      with:
        client-id: ${{ secrets.AZURE_CLIENT_ID }}
        client-secret: ${{ secrets.AZURE_CLIENT_SECRET }}
        tenant-id: ${{ secrets.AZURE_TENANT_ID }}
        subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}

    - name: 'Run Azure Functions Action'
      uses: Azure/functions-action@v1
      id: azure-functions
      with:
        app-name: ${{ inputs.azure-function-app-name }}
        package: ${{ inputs.azure-function-package-path }}